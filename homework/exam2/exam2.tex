\documentclass[12pt]{article}
\input{../hw.sty}

\usepackage{polynom}
\usepackage{textcomp}

\polyset{vars=x}

% \usepackage{maplestd2e}
%
% \def\emptyline{\vspace{12pt}}
%
% \DefineParaStyle{Maple Heading 1}
% \DefineParaStyle{Maple Text Output}
% \DefineParaStyle{Maple Dash Item}
% \DefineParaStyle{Maple Bullet Item}
% \DefineParaStyle{Maple Normal}
% \DefineParaStyle{Maple Heading 4}
% \DefineParaStyle{Maple Heading 3}
% \DefineParaStyle{Maple Heading 2}
% \DefineParaStyle{Maple Warning}
% \DefineParaStyle{Maple Title}
% \DefineParaStyle{Maple Error}
% \DefineCharStyle{Maple Hyperlink}
% \DefineCharStyle{Maple 2D Math}
% \DefineCharStyle{Maple Maple Input}
% \DefineCharStyle{Maple 2D Output}
% \DefineCharStyle{Maple 2D Input}

\title{Exam 2}
\author{Austin Gill}

\begin{document}
\maketitle

%% 1
\section{} \textit{When we talk about attacks on RSA, we usually talk about factoring $n$ into $pq$. But no one has been able to prove that this is the only way to find $d$ and $e$ given $n$. For example we could try to find $\varphi(n) = (p-1)(q-1)$ without first finding $p$ and $q$. Show that finding $\varphi(n)$ is sufficient to factor $n$ and therefore enough to find $d$.}

    Since $n = pq$, we have that $\varphi(n) = (p - 1)(q - 1)$:

    \begin{align*}
        \varphi(n) &= (p - 1)(q - 1)\\
                   &= pq - p - q + 1\\
                   &= n - p - q + 1\\
                   &= (n + 1) - (p + q)\\
        \varphi(n) - (n + 1) &= - (p + q)\\
        (n + 1) - \varphi(n) &= p + q\\
    \end{align*}

    Giving that $q = (n + 1) - \varphi(n) - p$. But then we have

    \begin{align*}
        n &= pq\\
        n &= p \cdot \left((n + 1) - \varphi(n) - p\right)\\
    \end{align*}

    But this is a quadratic in $p$, which is easily solvable:

    \begin{align*}
        n &= -p^2 + p(n + 1 - \varphi(n))\\
        p^2 &- (n + 1 - \varphi(n))p + n = 0\\
    \end{align*}

    which may be solved using the quadratic formula with

    \begin{align*}
        a &= 1\\
        b &= -(n + 1 - \varphi(n))\\
        c &= n\\
    \end{align*}

    So then we have

    $$p = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$$

    To test, we have

    \inputminted{python}{scripts/prob_1.py}

    which outputs

    \begin{minted}{python}
        (4811521585660301, 5473886613341039)
        (5473886613341039.0, 4811521585660301.0)
    \end{minted}

\newpage

%% 2 -- Unfortunately, even though Maple has the functionality to solve these easily, I must still
%%      solve them by hand...
\section{} \textit{Determine which of the following polynomials are irreducible over $\Z_2 [x]$.}

    %% Factors into (x^2 + x + 1)(x^3 + x + 1)
    \subsection{$x^5 + x^4 + 1$:}
    %% Irreducible
    \subsection{$x^5 + x^3 + 1$:}
    %% Factors into (x + 1)(x^4 + x + 1)
    \subsection{$x^5 + x^4 + x^2 + 1$:}

        Being far too much work to do by hand during this hellish time of year, the following Python script runs a brute force trial division test on each of the above polynomials in $\Z_2[x]$.

        \inputminted{python}{scripts/prob_2abc.py}

        and produces the following output

        \begin{minted}{python}
        Running trial division on: x**5 + x**4 + 1
            Found divisors: Poly(x**2 + x + 1, x, modulus=2) Poly(x**3 + x + 1, x, modulus=2)
            Found divisors: Poly(x**3 + x + 1, x, modulus=2) Poly(x**2 + x + 1, x, modulus=2)
        Running trial division on: x**5 + x**3 + 1
        Running trial division on: x**5 + x**4 + x**2 + 1
            Found divisors: Poly(x + 1, x, modulus=2) Poly(x**4 + x + 1, x, modulus=2)
        \end{minted}

        Thus the first and last polynomials are reducible over $\Z_2[x]$, while the second polynomial is irreducible. Interesting note, Maple does not factor $x^5 + x^4 + x^2 + 1$, but my Python code above does.

    \textit{The field $GF(2^8)$ can be constructed as $\Z_2[x] \pmod{x^8 + x^4 + x^3 + x + 1}$}

    %% x^6 + x^5 + x^3 + x^2 + x
    \subsection{Compute ${(x^5 + 1)}^{-1}$:}

        This can be done in multiple ways: I could run through the Extended Euclidean Algorithm, or I could brute force check all of the elements of $\Z_2[x] \pmod{x^8 + x^4 + x^3 + x + 1}$ to see which one(s) if any produce the multiplicative identity. Since $\Z_2[x] \pmod{x^8 + x^4 + x^3 + x + 1}$ has only $2^8$ elements, the latter approach is what I choose.

        \inputminted{python}{scripts/prob_2d.py}
    %% x^7 + x^4 + x^3 + x^2
    \subsection{Compute $(x^4 + x^2) \times (x^3 + x + 1)$:}

        Sadly, this problem was faster to do by hand:

        $$(x^4 + x^2) \times (x^3 + x + 1)$$
        $$x^7 + 2x^5 + x^4 + x^3 + x^2$$

        But this is in $\Z_2[x]$, so we then have

        $$x^7 + x^4 + x^3 + x^2$$

        But now we are working $\pmod{x^8 + x^4 + x^3 + x + 1}$. Clearly\texttrademark{}, however, $x^7 + x^4 + x^3 + x^2 \equiv x^7 + x^4 + x^3 + x^2 \pmod{x^8 + x^4 + x^3 + x + 1}$. Reducing $\pmod{x^8 + x^4 + x^3 + x + 1}$ with the \texttt{crypto.math.reduce\textunderscore{}gf28} function I wrote confirms this.

        \begin{minted}{python}
            >>> from crypto.math import reduce_gf28
            >>> f = (x **4 + x**2) * (x**3 + x + 1)
            >>> reduce_gf28(f)
            Poly(x**7 + x**4 + x**3 + x**2, x, modulus=2)
        \end{minted}

    These functions have now been implemented in \texttt{crypto.math.polynomial} as the following:

    \begin{itemize}
        \item \texttt{reduce\textunderscore{}gf28(poly)}
        \item \texttt{coeffs2poly(coeffs)}
        \item \texttt{poly\textunderscore{}trial\textunderscore{}factor(poly)}
        \item \texttt{poly\textunderscore{}trial\textunderscore{}inverse(poly)}
    \end{itemize}

\newpage

%% 3
\section{} \textit{My brother is color-blind, and we used to play snooker, if the balls had moved from their original positions he could not distinguished between a red and the green ball, as it is only the color that makes them non-identical. He was often skeptical that I was actually potting the balls in the correct order. I like to be able to prove to him that the two balls are in fact differently-colored. At the same time, I do not want him to learn which is red and which is green. Device a zero-knowledge protocol that allow me to prove that he really has two different colored balls in front of him. He is allowed to hold, move and handle the balls, I am only allowed to look at them. }

\newpage

%% 4 -- quite hard
\section{} \textit{Prove that an odd prime $p$ is expressible as a sum of two squares if and only if $p \equiv 1 \pmod{4}$.}

\newpage

%% 5
\section{} \textit{A common way of storing passwords on a computer is to use DES with a password as the key to encrypt a fixed plaintext (often just $000\dots0$). The ciphertext is then stored in a file. When someone log in, the procedure is repeated and the ciphertexts are compared. Why is this a better method than using the password as the plaintext and a fixed key?}

\newpage

%% 6
\section{} \textit{You have received the following message:}

    \begin{minted}[autogobble=false]{python}
        (949,   2750),  (8513,  28089), (5513,  8421),
        (4769,  4261),  (18352, 12856), (17914, 28599),
        (25231, 9196),  (3809,  5997),  (1477,  19626),
        (19108, 22326), (24966, 631),   (3494,  5974),
        (10256, 30308), (29093, 15082), (4223,  25106),
        (3595,  18546), (11325, 3588),  (5632,  4912),
        (18067, 13223), (21530, 3138),  (30949, 16065),
        (29784, 7987),  (6385,  5955),  (27338, 10405),
        (31715, 15969), (15815, 28055), (10462, 13371),
        (4852,  28393), (1331,  30788), (18117, 28680),
        (2472,  11786), (27548, 22909), (21980, 28433),
        (2154,  3440),  (21504, 22036), (13651, 18061),
        (10676, 26545), (30974, 23306), (14689, 8359)
    \end{minted}

\textit{It is an ElGamal ciphertext with the following parameters:}
    $$p = 31847$$
    $$\alpha = 5$$
    $$\beta = 18074$$
\textit{and your private random integer was}
    $$a = 7899$$
\textit{You also know that in order to translate the plaintext back into ordinary English text, you need to know how alphabetic characters were ``encoded'' as elements in $\Z_n$.  Each element of $\Z_n$ represent three alphabetic characters as in the following example:}

    \begin{align*}
        \text{DOG} &\to 3  \times 26^2 + 14 \times 26 + 6  = 2398\\
        \text{CAT} &\to 2  \times 26^2 + 0  \times 26 + 19 = 1371\\
        \text{ZZZ} &\to 25 \times 26^2 + 25 \times 26 + 25 = 17575\\
    \end{align*}

\textit{Decrypt the message (who sent it?), also explain why it is good that the first element in each pair is not the same.}

\newpage

%% 7 -- also quite hard
\section{} \textit{Find all primes $p$ such that}

    \subsection{$p \mid 2^p + 1$}

    \subsection{$p \mid 2^p - 1$}

\newpage

%% 8
\section{} \textit{I have five nieces and nephews, and I want to share a secret $(M)$ with them, and when three of them are in agreement they should be able to `unlock' it. I pick a prime $(p)$ larger than number of nieces and nephews and the secret number, $p = 17$. I calculate five pairs $(x_i, y_i)$ where $y_i \equiv M + s_1 x_i + s_2 x_i ^ 2\pmod{p}$, and $s_1, s_2$ are integers that only I know, and $x_1, \dots, x_5$ are distinct integers greater than $0$. Note that $f(0) \equiv M \pmod{p}$. I keep the polynomial secret, but I share $p$ and give each of them a $(x_i, y_i)$ pair. Three of them finally got together and agreed to try to solve my secret Lauren, Cohen and Kirian: (1, 8), (3, 10), and (5, 11). The trouble is they can't agree on the math, so they ask you for help to solve this. Calculate the Lagrange Interpolating Polynomial and identify the secret $(M)$.}


\end{document}
